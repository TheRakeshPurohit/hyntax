<html>
  <head>

    <style>
      body {
        display: flex;
        font-size: 18px;
      }

      .text,
      .attribute-key {
        color: #BABABA;
      }

      .tag {
        color: #E8BF6A;
      }

      .attribute-value {
        color: #A5C261;
      }

      .input {
        margin-right: 100px;
        padding: 20px 24px;
      }

      .output {
        background-color: #2B2B2B;
        padding: 20px 24px;
      }
    </style>
  </head>
  <body>
    <pre class="input"></pre>
    <pre class="output"></pre>

    <script src="./tokenize.bundle.js"></script>

    <script>
      function escapeHtml (unsafe) {
        return unsafe
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
      }

      const html = `
some text

<p class="description">
  some
  more text
</p>

<form class="test-form">
  <input type="input" disabled value="Disabled input">

  <input type="email" placeholder="Your Email">
  <button type="submit">Submit</button>
</form>

<img src="./test-image.png" />
      `

      const input = document.querySelector('.input')
      const output = document.querySelector('.output')
      const classesMap = {
        'token:open-tag-start': 'tag',
        'token:text': 'text',
        'token:attribute-key': 'attribute-key',
        'token:attribute-assignment': 'attribute-key',
        'token:attribute-value-wrapper-start': 'attribute-value',
        'token:attribute-value-wrapper-end': 'attribute-value',
        'token:attribute-value': 'attribute-value',
        'token:open-tag-end': 'tag',
        'token:close-tag': 'tag'
      }

      input.textContent = html.trim()

      const { tokens } = window.tokenize(input.innerText)

      let renderedTokens = ''
      let caret = 0

      tokens.forEach((token) => {
        const tail = input.innerText.substring(caret, token.startPosition)
        const tokenClass = classesMap[token.type] || ''

        renderedTokens += tail
        renderedTokens += `<span class="${ tokenClass }">${ escapeHtml(token.content) }</span>`

        caret = token.endPosition + 1
      })

      output.innerHTML = renderedTokens

    </script>
  </body>
</html>
